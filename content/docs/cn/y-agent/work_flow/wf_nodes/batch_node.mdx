---
title: 批处理节点
description: 批处理节点的详细配置和说明
---

## 什么是批处理节点？

批处理是一个可以将数组进行拆分处理的节点。

假设由5条数据，需要将这5条数据，每次取2条数据，进行处理。那么就可以使用批处理节点。

拆分后的结果如下：2+2+1

上面的例子里，2 代表每批大小，最后1条会被当单独一批处理。所以一共有3批数据。

如果需要每批数据，按时间顺序处理，可以将并发数设置为1。

如果需要一起处理，可以将并发数设置为大于等于总批次数量的数值。例如这里可以设置为3，这样就可以同时处理3批数据。

## 批处理节点的具体用法

在上面我们已经学会了如何将数据拆分成批次，那么如何使用这些数据呢？

其实批处理内可以创建流程，和流程图的使用方式一样。

只不过是这里的开始节点没有任何入参。

作为默认入参，有系统保留的关键字 `batch`, 代表当前批次的数据。

以上面的例子为例，假设我们有一个批处理节点，并设置批次大小为2。

那么在批处理节点内，我们可以使用 `{{ batch }}` 来获取当前批次的数据。

如果当前批次是 `[1, 2]`，那么 `{{ batch }}` 就会返回 `[1, 2]`。可以通过 `{% for doc in batch.item %}` 来遍历当前批次的数据。

具体例子如下：
```python
# 假设这里有5条数据
data = [
    {"id":1,"title":"标题1","content":"内容1"},
    {"id":2,"title":"标题2","content":"内容2"},
    {"id":3,"title":"标题3","content":"内容3"},
    {"id":4,"title":"标题4","content":"内容4"},
    {"id":5,"title":"标题5","content":"内容5"}
]
# 假设通过批处理节点拆分数据，设置批次大小为2

# 以下提示词代码用来取出每批里面的每个item
{% for doc in batch.item %}
{"编号：":"{{doc.id}}","标题：":"{{doc.title}}","内容：":"{{doc.content}}"}
{% endfor %}

```
